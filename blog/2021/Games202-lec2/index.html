<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Physics Based Animation: Mass Spring System | Yoharol's Blog </title> <meta name="author" content="Yuhan Wu"> <meta name="description" content="Do something interesting everyday. "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Gowun+Batang&amp;family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%90%AC&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://yoharol.github.io/blog/2021/Games202-lec2/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Yoharol's Blog </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Physics Based Animation: Mass Spring System</h1> <p class="post-meta"> Created on May 28, 2021 </p> <p class="post-tags"> <a href="/blog/2021"> <i class="fa-solid fa-calendar fa-sm"></i> 2021 </a>   ·   <a href="/blog/tag/note"> <i class="fa-solid fa-hashtag fa-sm"></i> note</a>   ·   <a href="/blog/category/research"> <i class="fa-solid fa-tag fa-sm"></i> research</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>What’s Langrangian view and Eulerian view? How to turn a mass spring system into linear equations system, and how to solve it? What is the most advanced research on this topic?</p> <h1 id="langrangian-view-and-eulerian-view">Langrangian View and Eulerian View</h1> <p>拉格朗日 随波逐流</p> <p>Langrangian View: sensors that move passively with the simulated material</p> <p>“What are <strong>my position and velocity</strong>?”</p> <p>Mostly particle physics, position based. Every particle has position and velocity.</p> <p>欧拉视角 岿然不动</p> <p>Eulerian View: sensors that never move</p> <p>“What is the <strong>material velocity passing by</strong>?”</p> <p>In Eulerian View, the field like flow velocity is represented as a function of position and time.</p> <p>Related link: <a href="https://en.wikipedia.org/wiki/Lagrangian_and_Eulerian_specification_of_the_flow_field" rel="external nofollow noopener" target="_blank">Lagrangian and Eulerian specification of the flow field</a></p> <h1 id="mass-spring-system-easiest-analysis">Mass Spring System: Easiest Analysis</h1> <p>Mass spring system</p> \[\begin{align*} \vec{f_{ij}}&amp;=-k(||\vec{x}_i-\vec{x}_j||_2 - l_{ij})(\widehat{\vec{x}_i-\vec{x}_j})\\ \vec{f}_i&amp;=\sum^{j\neq i}_j\vec{f}_{ij}\\ \frac{\partial\vec{v}_i}{\partial t}&amp;=\frac{1}{m_i}\vec{f_i}\\ \frac{\vec{x}_i}{\partial t}&amp;=\vec{v}_i \end{align*}\] <p>$k$:spring stiffness; $l_{ij}$: spring rest length between particle i and particle j;</p> <p>To calculate, we have two ways to do it.</p> <p>Explicit:</p> <ul> <li>Future depends only on past</li> <li>Easy to implement</li> <li> <p>Easy to explode:</p> \[\Delta t\leq c\sqrt{\frac{m}{k}}(c\sim 1)\] </li> <li>Bad for stiff materials(k is too large)</li> </ul> <p><strong>The updating frequency should allow the system to get close to steady situation</strong>. Imagine a mass spring that the stiffness is too large, so the next frame the whole system already move past the steady point and get much far away in opposite direction, then the whole system will “explode”.</p> <p>Implicit:</p> <ul> <li>Future depends on <strong>both future and past</strong> </li> <li>Need to solve a system of (linear) equations</li> <li>In general harder to implement</li> <li>Each step is more expensive but time steps are larger</li> <li>Numerical damping and locking.</li> </ul> <h1 id="solving-mass-spring-system">Solving Mass Spring System</h1> <p>To solve the whole system, there are three approaches:</p> <ol> <li> <p>Forward Euler(explicit)</p> \[\begin{align*} \vec{v}_{t+1}&amp;=\vec{v}_t + \Delta t\frac{\vec{f}_t}{m}\\ \vec{x}_{t+1}&amp;=\vec{x}_t + \Delta t\vec{v}_t \end{align*}\] </li> <li> <p>Semi-implicit Euler(aka. symplectic Euler, explicit, commonly used)</p> \[\begin{align*} \vec{v}_{t+1}&amp;=\vec{v}_t + \Delta t\frac{\vec{f}_t}{m}\\ \vec{x}_{t+1}&amp;=\vec{x}_t + \Delta t\vec{v}_{t+1} \end{align*}\] </li> <li> <p>Backward Euler(often with Newton’s method, implicit)</p> <p>$v_{t+1}$ relies to force $f(x_{t+1})$, we’ll use $M^{-1}$ as a abbreviation from position to force.</p> \[\begin{align*} \vec{x}_{t+1}&amp;=\vec{x}_t + \Delta t\vec{v_{t+1}}\\ \vec{v}_{t+1}&amp;=\vec{v}_t + \Delta t M^{-1}\vec{f}(\vec{x}_{t+1}) \end{align*}\] <p>This is a set of equations. To eliminate $\vec{x}_{t+1}$:</p> \[\vec{v}_{t+1} = \vec{v}_t + \Delta t M^{-1}f(\vec{x}_t + \Delta t\vec{v}_{t+1})\] <p>$M^{-1}$ is ordinarily not linear, so the equation is hard to solve. <strong>To linearize(one step of Newton’s method, which is a Taylor Expansion):</strong></p> \[\vec{v}_{t+1}=\vec{v}_t + \Delta t M^{-1}[\vec{f}{x_t} + \frac{\partial f}{\partial x}(x_t)\Delta t \vec{v}_{t+1}]\] <p>Clean it up, we finally get a linear equation:</p> \[[I-\Delta t^2 M^{-1}\frac{\partial f}{\partial x}(\vec{x}_t)] \vec{v}_{t+1} = \vec{v}_t + \Delta t M^{-1}f(\vec{x}_t)\] </li> </ol> <h1 id="solving-linear-system-jacobi-iterations">Solving Linear System: Jacobi Iterations</h1> <p>How to solve the linear system?</p> <ul> <li>Jacobi/Gauss-Seidel iterations (easy to implement)</li> <li>Conjugate gradients (later in this course)</li> </ul> <p>We’ll start with the Jacobi iterations. First, we’ll simplify the equation to a linear form:</p> \[\begin{align*} A&amp;=[I-\Delta t^2 M^{-1}\frac{\partial f}{\partial x}(x_t)]\\ b&amp;=v_t + \Delta tM^{-1}f(x_t) \end{align*}\] <p>Now we have a general linear equation $Av_{t+1}=b$. In Jacobi iterations, A can be decomposed into the sum of a diagonal component, a lower triangular part and an upper triangular part.</p> \[A = D + L + U\] \[D=\begin{bmatrix} a_{11} &amp; 0 &amp; \cdots &amp; 0 \\ 0 &amp; a_{22} &amp; \cdots &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0 &amp; 0 &amp; \cdots &amp; a_{nn} \end{bmatrix}\] <p>Then we can build a ‘<strong>fake equalization</strong>’:</p> \[D x^{(k+1)} + (L+U)x^{(k)} = b\] <p>Find solution in an iteration process:</p> \[x^{(k+1)}=D^{-1}(b-(L+U)x^{(k)})\] <p>The minimum amount of storage is two vectors of size n. Jacobi iteration is useful because sometimes A is a <strong>sparse matrix</strong>, and $A^{-1}$ is hard to calculate, also may not be a sparse matrix anymore which requires much more storage. The process of Jacobi iteration use the original form of A without generate any other matrices.</p> <p>Note: Jacobi iteration does not always converge. We can easily prove that</p> \[v^{(k+1)}-v=D^{-1}(L+U)(v^{(k)}-v)\] <p>The <strong>condition of convergence</strong> is $\rho (D^{-1}(L+U))&lt;1$. Since we are discussing a sparse matrix, this condition seems apparently satisfied. For more information, check <a href="https://en.wikipedia.org/wiki/Jacobi_method#Convergence" rel="external nofollow noopener" target="_blank">here</a>.</p> <h1 id="advanced-reading">Advanced Reading</h1> <ul> <li>Smoothed-particle hydrodynamics(<a href="https://en.wikipedia.org/wiki/Smoothed-particle_hydrodynamics" rel="external nofollow noopener" target="_blank">SPH</a>)</li> <li>Weakly Cmpressible SPH(<a href="https://en.wikipedia.org/wiki/Smoothed-particle_hydrodynamics#Weakly_compressible_approach" rel="external nofollow noopener" target="_blank">WCSPH</a>) to simulate water</li> <li>SPH in computer graphics(<a href="https://people.inf.ethz.ch/~sobarbar/papers/Sol14/2014_EG_SPH_STAR_Presentation.pdf" rel="external nofollow noopener" target="_blank">Presentation</a>)</li> <li>SPH techniques for the physics based simulation of fluid and solids(<a href="https://interactivecomputergraphics.github.io/SPH-Tutorial/" rel="external nofollow noopener" target="_blank">Github Page</a>)</li> <li>Courant-Friedrichs-Lewy condition(<a href="https://en.wikipedia.org/wiki/Courant%E2%80%93Friedrichs%E2%80%93Lewy_condition" rel="external nofollow noopener" target="_blank">CFL</a>)</li> <li>Smoothed Particle Hydrodynamics (SPH) implemented with C++ and CUDA(<a href="https://github.com/TroyZhai/CPP-Fluid-Particles" rel="external nofollow noopener" target="_blank">Github Page</a>)</li> <li>Interlinked SPH Pressure Solvers for Strong Fluid-Rigid Coupling(C. Gissler et al.)</li> <li>耦合：两种不同的物理模拟系统能够双向交互</li> <li>From particles to Surfaces: Marching Cube, VDB</li> </ul> <p>Other partical-based simulation methods:</p> <ul> <li>Discrete element method(Particle based simulation for granular materials, 2005)</li> <li>Moving particle semi-implicit (Moving-particle semi-implicit method for fragmentation of incompressible fluid, 1996)</li> <li>Power Particles: An incompressible fluid solver based on power diagrams(Particles: an incompressible fluid solver based on power diagrams, 2015)</li> <li>A peridynamic perspective on spring-mass fracture(J. A. Levine et al.(2014))</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/LargeMatrix/">Write Summation as Matrix</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/InverseKinematics/">Inverse Kinematics</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/Rotation/">Representations of Rotation and Derivation</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/SSH-test/">Assembly Language and Language C</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/Pointers-in-Cpp/">Note: Pointer in C++</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Yuhan Wu. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>